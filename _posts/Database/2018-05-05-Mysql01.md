---
title: Mysql（一）
date: 2018-05-05 19:01:09
categories:
    - Mysql
tags:
    - Database
    - Mysql
---

记录Mysql相关的基础知识。

<!-- more -->


##### 目录
+ I.数据库
+ II.SQL
+ III.Mysql基础
+ 


---
# I.数据库

一组数据集合。体现在计算机中，就是一个文件系统。把数据保存到这些文件中，然后使用特定的语言（SQL语言）操作文件中的数据。

## DBMS
数据库管理系统：Database Management System，用于管理数据库的软件系统，包括和用户、应用、数据库本身的交互。一般具有存储、截取、安全保障、备份等基础功能。通常根据使用的数据库模型，对DBMS分类：[关系型](https://en.wikipedia.org/wiki/Relational_database_management_system)、[非关系型（NoSQL）](https://en.wikipedia.org/wiki/NoSQL)、[NewSQL](https://en.wikipedia.org/wiki/NewSQL)。

> SQL是RDBMS的代名词，NoSQL也就成了Non-Relational的代名词。也有人把NewSQL划入NoSQL

- 关系型：Oracle、MySql、Microsoft SQLServer、IBM DB2、PostgreSQL、Sybase等。
- 非关系型（Not Only SQL）
    + k-v数据库：Redis
    + 列存储数据库：HBase、Apache Cassandra
    + 文档型数据库：MongoDB、CouchDB
    + 图形数据库：Neo4J
- NewSQL：TiDB

大部分公司以RDBMS为主，辅以NoSQL。因为RDBMS历史悠久、稳定可靠、生态完善、事务特性。

> 关于NewSQL

NewSQL是传统RDBMS与NoSQL技术的结合。在保障传统数据库系统ACID的同时，寻求在线事务处理（OLTP，online transaction processing）和NoSQL可伸缩性的结合。可以理解成"分布式关系型数据库"。

## E-R实体图

[Entity Relationship Diagram](https://en.wikipedia.org/wiki/Entity%E2%80%93relationship_model)。用于数据库设计，描述实体间关系。3个核心概念：

- 实体：对应Java对象，使用矩形表示
- 属性：实体属性，使用椭圆表示
- 关系：实体间关系，使用菱形表示

其中关系包括：一对一（1:1）、一对多（1：N）、多对多（M：N）。

![avatar](http://blog-wocaishiliuke.oss-cn-shanghai.aliyuncs.com/images/Database/E-R%20example.png)


---
# II.SQL

Structured Query Language，结构化查询语言，用于RDBMS的CRUD、管理等操作。

- SQL语句不依赖于平台，对所有的数据库通用
- SQL语句是非过程性的语言，每条SQL执行完都会有具体的结果

## 1.SQL标准

1986年10月，美国国家标准局（ANSI）通过了SQL数据库语言美国标准。接着，国际标准化组织（ISO）颁布了SQL国际标准。1989年4月，ISO提出了具有完整性特征的SQL89标准，1992年11月公布了SQL92标准，随后是SQL:1999、SQL:2003、SQL:2008、SQL:2011、SQL:2016。

不同数据库对SQL标准的支持存在着细微的不同，因为有些产品的开发先于标准的公布。另外，各产品为了实现不同的特性，对标准进行了扩展。

## 2.分类

#### DQL
Data Query Language，数据查询语言。
常用词：SELECT、WHERE、ORDER BY、GROUP BY、HAVING

```sql
select * from user where id=1;
```

#### DML
Data Manipulation Language，数据操作语言。
常用词：INSERT、UPDATE、DELETE

```sql
insert into user(xx,xx) values(yy,yy);
update user set x=y,x1=y1 where id=1;
delete from user where id=1;
```

#### DDL
Data Definition Language，数据定义语言。用于定义数据库对象，如表table、视图view、索引index、储存过程PROCEDURE、触发器TRIGGER、模式SCHEMA、域DOMAIN等
常用词：CREATE、DROP、ALTER

#### DCL
Data Control Language，数据控制语言。用于设置用户权限和事务控制的语句
常用词：GRANT、REVOKE、DENY

```sql
grant DBA to alvin with admin option;
revoke DBA from alvin;
```

#### TPL
Transaction Processing Language，事务处理语言。用于保证DML语句影响的数据被及时更新。
常用词：BEGIN TRANSACTION、COMMIT、ROLLBACK

#### CCL
指针控制语言。像DECLARE CURSOR、FETCH INTO和UPDATE WHERE CURRENT，用于对一个或多个表单独行的操作。


---
# III.Mysql基础

## 1.安装

Mysql安装、卸载以及Workbench安装可参考[Ubuntu环境搭建](http://blog.wocaishiliuke.cn/linux/2018/06/02/Ubuntu01/)

> Mysql8.0的java驱动包的groupId有变动，所以谨慎选择要使用的版本。

## 2.数据类型

这里只做简单介绍，更多可参考[Data Types](https://dev.mysql.com/doc/refman/5.7/en/data-types.html)

- 数值类型：Numeric Type
- 日期类型：Date and Time Type
- 字符类型：String Type

#### 数值类型

> Integer Types (Exact Value) 

除了SQL标准的INTEGER(or INT)和SMALLINT，MySQL还额外支持了3种。

|Type|Storage (Bytes) Minimum Value Signed|Minimum Value Unsigned|Maximum Value Signed|Maximum Value Unsigned|
|:----|:---|:-----|:------|:-----|:---|
|TINYINT|1|-128|0|127|255|
|SMALLINT|2|-32768|0|32767|65535|
|MEDIUMINT|3|-8388608|0|8388607|16777215|
|INT|4|-2147483648|0|2147483647|4294967295|
|BIGINT|8|-2^63|0|2^63-1|2^64-1|

> Fixed-Point Types (Exact Value)

MySQL中，DECIMAL和NUMERIC可认为是相同的类型。MySQL以二进制格式保存DECIMAL值，实现准确存储。

```sql
# M表示总位数，1-65，默认10；D表示小数点后位数，0-30，并且D＜M，默认0
column DECIMAL(M,D)
# -999.99 to 999.99
salary DECIMAL(5,2)
```

> Floating-Point Types (Approximate Value)

FLOAT和DOUBLE类型表示近似值。MySQL中，单精度占4字节，双精度占8字节。



#### 字符串型 

Java中的String、char，对应mysql的varchar(长度)、char(长度)

varchar和char区别：
- 1.varchar变长，char定长。即数据长度不足时，char类型会使用空格补满；varchar则不作处理
- 2.char最多放255个字符，与编码无关；varchar最多放65532个字符，有效长度还取决于编码集

> 日期

Java：Date（年月日时分秒）、Time、DateTime、TimeStamp（1970-1-1 0:0:0）
mysql：DATE(只有年月日)、TIME、DATETIME、TIMESTAMP 

timestamp和datetime都可以保存年月日时分秒，它们的区别：

- 1.TIMESTAMP会把时间转化为UTC时间存储，查询时再转化为当前时区返回；DATATIME原样插入和输出
- 2.在MySQL5.6.5之前，TIMESTAMP在保存和更新数据时，该列会自动更新为保存和修改数据的时间，DATATIME不会。从MySQL5.6.5开始，该自动更新两者都适用。关于自动更新，可参考[Automatic Initialization and Updating for TIMESTAMP and DATETIME](https://dev.mysql.com/doc/refman/5.6/en/timestamp-initialization.html)。






## 3.基本语句

#### 2.1 database操作

```sql
# 登录
mysql -u root -p

# 库操作
show databases;             # 所有库
show create database test;  # 库创建语句

create database test
create database test charset utf8 [collate 排序规则];
create database test character set utf8 [collate 排序规则];
drop database test;
alter database test charset gbk;
alter database test character set gbk;

select database();
use test;
```

#### 2.2 table操作

