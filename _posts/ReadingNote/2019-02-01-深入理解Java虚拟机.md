---
title: 读书笔记-深入理解Java虚拟机
date: 2019-02-01 00:00:00
categories:
    - ReadingNote
tags:
    - ReadingNote
    - JVM
---

本文记录周志明《深入理解Java虚拟机》第2版的读书笔记。

<!-- more -->

##### 目录
+ I.前言
+ II.走进Java

---

# I.前言

Java技术在虚拟机层面隐藏了底层技术的复杂性，以及机器与操作系统的差异性。Java虚拟机在千差万别的物理机上建立了统一的运行平台，write once run anywhere。相比于C/C++开发，开发人员可以把主要精力放在业务逻辑上，而非物理硬件的兼容性上。JVM在底层完成对硬件平台的兼容和对内存等资源的管理工作。但事物具有两面性，这是Java的优点，但也是开发人员的弱点。

很多时候提升硬件效能，无法等比例地提升程序性能和并发能力。这跟JVM有一定的关系：为了达到为所有平台提供统一的虚拟平台的目的，牺牲了一些与硬件相关的性能。但更多的是人为原因：不了解JVM，无法写出最适合JVM运行和自优化的代码

# II.走进Java

Java既是一门编程语言，也是由一系列软件和规范组成的技术体系。应用在服务器、移动终端、手持设备、嵌入式系统等。优点：

- 1.跨平台：摆脱硬件平台束缚，一次编写到处运行
- 2.安全性：相对安全的内存管理和访问机制，避免绝大部分的内存泄漏和指针越界问题
- 3.热点代码检测和运行时编译及优化
- 4.完善的应用程序接口、第三方类库和框架，社区生态良好



## 1.6 编译JDK

了解JDK的内部实现机制，最好自己编译一套JDK，也方便对JDK底层方法的Hack。开源JDK实现很多，这里使用OpenJDK（Sun系列的）

#### 1.6.1 获取JDK源码

###### OpenJDK和Sun/OracleJDK关系

OpenJDK是Sun在2006年把Java开源形成的项目。OracleJDK采用商业实现，OpenJDK采用开源实现。

- 1.OracleJDK中存在一些OpenJDK没有的、商用闭源的功能
- 2.OpenJDK中的字体渲染、文件头版权注释等和OracleJDK稍有不同

**总之，两者十分接近。自行编译的OpenJDK基本可以认为在性能、功能、执行逻辑上都和官方的OracleJDK一致。**

###### OpenJDK的版本关系

参考书中原文。这里采用OpenJDK7u6

###### 源码获取方式

- 1.使用Mercurial代码管理工具，直接从[源码Repository](http://hg.openjdk.java.net/jdk7u/jdk7u)获取（需要安装hg）
- 2.下载官方打包的源码，官网上[OpenJDK7](https://download.java.net/openjdk/jdk7)的下载超链接有误（坑），可在[这里](http://download.java.net/openjdk/jdk7/promoted/b147/openjdk-7-fcs-src-b147-27_jun_2011.zip)下载。[OpenJDK6](https://download.java.net/openjdk/jdk6)中的下载链接正确

> 这里下载OpenJDK7的最后更新：openjdk-7-fcs-src-b147-27\_jun\_2011.zip

#### 1.6.2 系统需求

安装细节可参考[README-builds](http://hg.openjdk.java.net/jdk7u/jdk7u/raw-file/tip/README-builds.html#get_source)文档。

推荐Linux、MacOS或Solaris，Windows上稍麻烦。保证硬盘空间5G

> 这里是在Ubuntu 18.04LTS 64位系统上进行编译

#### 1.6.3 构建编译环境

这里只介绍Ubuntu上环境的搭建，其他系统可参考原书