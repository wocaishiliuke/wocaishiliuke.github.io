---
title: Mybatis映射文件（1）
date: 2018-08-07 20:01:09
categories:
    - Mybatis
tags:
    - Mybatis
    - Basic
    - Java
---

MyBatis是针对SQL构建的。它的强大在于映射语句，且映射器的XML文件相对简单。与相同功能的JDBC代码相比，会节约近95%代码。

<!-- more -->

##### 目录

> MyBatis的SQL映射文件有很少的几个顶级元素，它们也有一定的定义顺序，可[参见官网](http://www.mybatis.org/mybatis-3/zh/sqlmap-xml.html)。这里按常用的顺序先介绍如下几个

+ I.CRUD标签
+ II.sql片段
+ III.#{}和${}
+ IV.传参接参
+ V.参考

---

# I.CRUD标签

#### 1.select
> 该标签的属性比update、delete、insert要多，体现出select的使用较频繁，具体属性参考[官方文档](http://www.mybatis.org/mybatis-3/zh/sqlmap-xml.html#select)，以下介绍常用的简单属性

- id：当前名称空间下的该statement的唯一标识，必填。一般id和mapper接口中的方法的名字一致。(使用动态代理之后，必须一致)
- resultType：将结果集映射为java的对象类型，必填（和resultMap二选一）
- parameterType：传入参数类型，可省略

```
<select id="queryUserById" resultType="com.baicai.mybatis.pojo.User" parameterType="long">
    select * from tb_user where id = #{id}
</select>
```

#### 2.insert

> insert和update/delete相比，多了几个主键回写的属性，另外它们3个都没有resultType/resultMap属性哦(有selectKey)

- id属性：同上
- parameterType：传入的参数类型，可省略
- 特有属性：主键回写（useGeneratedKeys开启主键回写，将keyColumn字段的值，回显到对象的keyProperty属性中，直接代码中user.getId()即可获取到）

<insert id="insert" parameterType="user" useGeneratedKeys="true" keyColumn="id" keyProperty="id">
        INSERT INTO tb_user(id, user_name, password, name, age, sex, birthday, created, updated) 
        VALUES(null, #{userName}, #{password}, #{name}, #{age}, #{sex}, #{birthday}, now(), now())
</insert>
关于主键会写，官方给出两种方式，这里是其中一种。oracle没有自增主键，只能使用第二种（selectKey），而MySQL和SQL Server支持自动生成主键的字段，可以上述这种方式，详见官方文档
8.1.3.update
id属性：同上
parameterType：传入的参数类型，可以省略。
也可以回写主键(使用selectKey)，但是本身就是根据id修改，所以意义不大
<update id="update" parameterType="uSer">
    UPDATE tb_user SET user_name = #{userName}, password = #{password}, name = #{name}, age = #{age}, sex = #{sex}, birthday = #{birthday}, updated = now()
    WHERE id = #{id}
</update>
8.1.4.delete
id属性：同上
parameterType：传入的参数类型，可以省略。
<!-- 全名应该是java.lang.Long,这里用Long/long，甚至lOnG都可以 -->
<delete id="deleteById" parameterType="Long">
    DELETE FROM tb_user WHERE id = #{id}
</delete>
